<!DOCTYPE html>
<!-- saved from url=(0040)http://localhost:4000/dqn-investigation/ -->
<html lang="en" class="js fontawesome-i2svg-active fontawesome-i2svg-complete"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

<!-- begin _includes/seo.html --><title>Investigating the effect of DQN tricks on RL divergence - Omar’s Blog</title>
<meta name="description" content="Deep Q Networks (DQN) revolutionized the Reinforcement Learning world. It was the first algorithm able to learn a successful strategy in a complex environment immediately from high-dimensional image inputs. In this blog post, we investigate how some of the techniques introduced in the original paper contributed to its success. Specifically, we investigate to what extent memory replay and target networks help prevent divergence in the learning process.">


  <meta name="author" content="Omar Elbaghdadi">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Omar&#39;s Blog">
<meta property="og:title" content="Investigating the effect of DQN tricks on RL divergence">
<meta property="og:url" content="http://localhost:4000/dqn-investigation/">


  <meta property="og:description" content="Deep Q Networks (DQN) revolutionized the Reinforcement Learning world. It was the first algorithm able to learn a successful strategy in a complex environment immediately from high-dimensional image inputs. In this blog post, we investigate how some of the techniques introduced in the original paper contributed to its success. Specifically, we investigate to what extent memory replay and target networks help prevent divergence in the learning process.">



  <meta property="og:image" content="http://localhost:4000/assets/images/posts/2020/dqn-investigation/space_invaders.png">





  <meta property="article:published_time" content="2020-10-11T22:38:20+02:00">





  

  


<style type="text/css">svg:not(:root).svg-inline--fa{overflow:visible}.svg-inline--fa{display:inline-block;font-size:inherit;height:1em;overflow:visible;vertical-align:-.125em}.svg-inline--fa.fa-lg{vertical-align:-.225em}.svg-inline--fa.fa-w-1{width:.0625em}.svg-inline--fa.fa-w-2{width:.125em}.svg-inline--fa.fa-w-3{width:.1875em}.svg-inline--fa.fa-w-4{width:.25em}.svg-inline--fa.fa-w-5{width:.3125em}.svg-inline--fa.fa-w-6{width:.375em}.svg-inline--fa.fa-w-7{width:.4375em}.svg-inline--fa.fa-w-8{width:.5em}.svg-inline--fa.fa-w-9{width:.5625em}.svg-inline--fa.fa-w-10{width:.625em}.svg-inline--fa.fa-w-11{width:.6875em}.svg-inline--fa.fa-w-12{width:.75em}.svg-inline--fa.fa-w-13{width:.8125em}.svg-inline--fa.fa-w-14{width:.875em}.svg-inline--fa.fa-w-15{width:.9375em}.svg-inline--fa.fa-w-16{width:1em}.svg-inline--fa.fa-w-17{width:1.0625em}.svg-inline--fa.fa-w-18{width:1.125em}.svg-inline--fa.fa-w-19{width:1.1875em}.svg-inline--fa.fa-w-20{width:1.25em}.svg-inline--fa.fa-pull-left{margin-right:.3em;width:auto}.svg-inline--fa.fa-pull-right{margin-left:.3em;width:auto}.svg-inline--fa.fa-border{height:1.5em}.svg-inline--fa.fa-li{width:2em}.svg-inline--fa.fa-fw{width:1.25em}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers-text{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter{background-color:#ff253a;border-radius:1em;-webkit-box-sizing:border-box;box-sizing:border-box;color:#fff;height:1.5em;line-height:1;max-width:5em;min-width:1.5em;overflow:hidden;padding:.25em;right:0;text-overflow:ellipsis;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-bottom-right{bottom:0;right:0;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom right;transform-origin:bottom right}.fa-layers-bottom-left{bottom:0;left:0;right:auto;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom left;transform-origin:bottom left}.fa-layers-top-right{right:0;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-top-left{left:0;right:auto;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top left;transform-origin:top left}.fa-lg{font-size:1.3333333333em;line-height:.75em;vertical-align:-.0667em}.fa-xs{font-size:.75em}.fa-sm{font-size:.875em}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:2.5em;padding-left:0}.fa-ul>li{position:relative}.fa-li{left:-2em;position:absolute;text-align:center;width:2em;line-height:inherit}.fa-border{border:solid .08em #eee;border-radius:.1em;padding:.2em .25em .15em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left,.fab.fa-pull-left,.fal.fa-pull-left,.far.fa-pull-left,.fas.fa-pull-left{margin-right:.3em}.fa.fa-pull-right,.fab.fa-pull-right,.fal.fa-pull-right,.far.fa-pull-right,.fas.fa-pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}.fa-pulse{-webkit-animation:fa-spin 1s infinite steps(8);animation:fa-spin 1s infinite steps(8)}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.fa-rotate-90{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-webkit-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-webkit-transform:scale(-1,1);transform:scale(-1,1)}.fa-flip-vertical{-webkit-transform:scale(1,-1);transform:scale(1,-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{-webkit-transform:scale(-1,-1);transform:scale(-1,-1)}:root .fa-flip-both,:root .fa-flip-horizontal,:root .fa-flip-vertical,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-rotate-90{-webkit-filter:none;filter:none}.fa-stack{display:inline-block;height:2em;position:relative;width:2.5em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.svg-inline--fa.fa-stack-1x{height:1em;width:1.25em}.svg-inline--fa.fa-stack-2x{height:2em;width:2.5em}.fa-inverse{color:#fff}.sr-only{border:0;clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}.svg-inline--fa .fa-primary{fill:var(--fa-primary-color,currentColor);opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa .fa-secondary{fill:var(--fa-secondary-color,currentColor);opacity:.4;opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-primary{opacity:.4;opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-secondary{opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa mask .fa-primary,.svg-inline--fa mask .fa-secondary{fill:#000}.fad.fa-inverse{color:#fff}</style><link rel="canonical" href="http://localhost:4000/dqn-investigation/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Omar Elbaghdadi",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Omar&#39;s Blog Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4000/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:4000/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:4000/favicon/favicon-16x16.png">
<link rel="manifest" href="http://localhost:4000/favicon/site.webmanifest">
<link rel="mask-icon" href="http://localhost:4000/favicon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->

<link href="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/css" rel="stylesheet"> 

  <script src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/free.min.js" data-auto-a11y="true" defer=""></script><script src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/embed.js" data-timestamp="1602448786014"></script><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><link rel="prefetch" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.d70637fa1c39d358d2553bf476f09a98.css"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.63145499704f9a276b6c681c79021303.js"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.a45eea237b8ac398e54e1765ef73d9da.js"><link rel="prefetch" as="script" href="https://disqus.com/next/config.js"><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

  <body class="layout--single" style="margin-bottom: 219.156px;"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="http://localhost:4000/dqn-investigation/#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="http://localhost:4000/dqn-investigation/#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="http://localhost:4000/dqn-investigation/#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="http://localhost:4000/"><img src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/logo.png" alt=""></a>
        
        <a class="site-title" href="http://localhost:4000/">
          Omar's Blog
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="http://localhost:4000/">Blog</a>
            </li><li class="masthead__menu-item">
              <a href="http://localhost:4000/about/">About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button" count="0" style="">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  

  <article class="page" itemscope="" itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Investigating the effect of DQN tricks on RL divergence">
    <meta itemprop="description" content="Deep Q Networks (DQN) revolutionized the Reinforcement Learning world. It was the first algorithm able to learn a successful strategy in a complex environment immediately from high-dimensional image inputs. In this blog post, we investigate how some of the techniques introduced in the original paper contributed to its success. Specifically, we investigate to what extent memory replay and target networks help prevent divergence in the learning process.">
    <meta itemprop="datePublished" content="October 11, 2020">
    

    <div class="page__inner-wrap">
      
      <header>
          
            <p class="page__date"><time datetime="2020-10-11T22:38:20+02:00">October 11, 2020</time></p>
          
          <h1 id="page-title" class="page__title" itemprop="headline">Investigating the effect of DQN tricks on RL divergence
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><svg class="svg-inline--fa fa-file-alt fa-w-12" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-alt" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" data-fa-i2svg=""><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"></path></svg><!-- <i class="fas fa-file-alt"></i> Font Awesome fontawesome.com --> On this page</h4></header>
              <ul class="toc__menu">
  <li class=""><a href="http://localhost:4000/dqn-investigation/#background">Background</a>
    <ul>
      <li class=""><a href="http://localhost:4000/dqn-investigation/#reinforcement-learning">Reinforcement Learning</a></li>
      <li class=""><a href="http://localhost:4000/dqn-investigation/#q-learning">-Learning</a></li>
      <li class=""><a href="http://localhost:4000/dqn-investigation/#function-approximation">Function Approximation</a></li>
      <li class=""><a href="http://localhost:4000/dqn-investigation/#experience-replay">Experience Replay</a></li>
      <li class=""><a href="http://localhost:4000/dqn-investigation/#target-networks">Target Networks</a></li>
    </ul>
  </li>
  <li class=""><a href="http://localhost:4000/dqn-investigation/#divergence">Divergence</a></li>
  <li class="active"><a href="http://localhost:4000/dqn-investigation/#experimental-setup">Experimental setup</a></li>
  <li class=""><a href="http://localhost:4000/dqn-investigation/#results-and-discussion">Results and Discussion</a></li>
  <li class=""><a href="http://localhost:4000/dqn-investigation/#conclusions">Conclusions</a></li>
</ul>
            </nav>
          </aside>
        
        <p>Deep Q Networks (DQN) revolutionized the Reinforcement Learning world. It was the first algorithm able to learn a successful strategy in a complex environment immediately from high-dimensional image inputs. In this blog post, we investigate how some of the techniques introduced in the original paper contributed to its success. Specifically, we investigate to what extent <strong>memory replay</strong> and <strong>target networks</strong> help prevent <strong>divergence</strong> in the learning process.</p>

<!--more-->

<p>Reinforcement Learning (RL) has already been around for a while, but it is not even close to being solved yet. While <em>supervised learning</em> can already be quite difficult, RL methods also need to deal with changes in the data distribution, huge state spaces, partial observability, and various other issues. In 2013, the paper <a href="https://www.cs.toronto.edu/~vmnih/docs/dqn.pdf" target="_blank">Playing Atari with Deep Reinforcement Learning (Mnih et al.)</a> introduces <strong>DQN, the first RL method to successfully learn good policies directly from high-dimensional inputs using neural networks</strong>. The algorithm performs better than human experts in several Atari games, learning directly from image input.</p>

<!--- ![pic alt](/assets/images/posts/2020/dqn-investigation/space_invaders_games_2.png "opt title") -->

<div class="figure">
    <figure>
        
        <img class="align-center" src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/space_invaders_games_2.png" alt="image" style="width:; align:center;margin-bottom: 0.4em;">
        
    
        <figcaption class="align-center">
Screenshots from three Atari 2600 Games: (Left-to-right) Pong, Breakout, and Space Invaders.
</figcaption>
    
</figure>
</div>

<p>DQN introduces several techniques to stabilize the learning process. In this post, we take a look at two of them, <strong>memory replay</strong> and <strong>target networks</strong>. We run our own experiments, investigating to what degree each of the techniques in this process. This in turn gives us better insight into the learning dynamics of Q-learning with neural network function approximation. This is important, as a better understanding of these learning dynamics allows us to focus further research on the most promising methods (and other things?).</p>

<p>The rest of this post is outlined as follows:</p>
<ul>
  <li>We first develop a little bit of the <strong>background</strong>, briefly going into RL, Q-Learning, function approximation with neural networks, and the DQN algorithm.</li>
  <li>We then give a definition of <strong>divergence</strong>, which we use in our experiments.</li>
  <li>We describe the <strong>experimental setup</strong>,</li>
  <li>after which we <strong>discuss</strong> the results.</li>
</ul>

<!--- - While RL has been around for a while, first time shown to work well with high-dimensional sensory input in 2013 (or 2015) by DQN paper.
- they did this by successfully playing multiple Atari games using the same learning framework, even beating human expert players in some of them.
- function approximation with neural networks had been around for a while, but never succeeded
- DQN introduced some tricks that helped: Experience replay memory, and target networks
- In this blog post, we explore to what extent each of the techniques introduced by DQN contributed to its success
- Specifically, we investigate to what extent each of the techniques avoid divergence in the learning process.
- This in turn gives us insight into the learning dynamics of Q-learning with neural network function approximation. A better understanding of these learning dynamics allows us to focus research on the most promising methods and give us insight into the more important aspects of learning. -->

<h2 id="background" class="">Background</h2>

<p>In this post, we will just give a brief overview of the main techniques, and not go too deep into all the background theory. If you want to dig deeper, we suggest checking out <a href="https://www.cs.toronto.edu/~vmnih/docs/dqn.pdf" target="_blank">the original paper</a>.</p>

<h3 id="reinforcement-learning" class="">Reinforcement Learning</h3>
<!--- - 2 or 3 sentences about RL in general
In Reinforcement Learning (RL), an agent learns to take good actions by optimizing a scalar reward given by its environment. The agent learns to map the current state of the world to a probability distribution over its actions, which we call a policy. -->

<p>In RL, we study an <strong>agent</strong> interacting with some <strong>environment</strong>. The agent learns to take good actions by optimizing a <strong>scalar reward</strong> given by its environment. The agent learns to map the current state of the world, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.478em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.798em, 1000.44em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 0.639em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">s</script>, to a probability distribution over its actions <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 3.961em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.191em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.505em, 1003.08em, 2.714em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main; padding-left: 0.295em;">∣</span><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.295em;">s</span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.361em; border-left: 0px solid; width: 0px; height: 1.32em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2">\pi(a \mid s)</script>, which we call a policy. In an Atari game, the game is the environment, and the player is the agent who is trying to maximize their score by learning a good policy.</p>

<p>The environment provides us with a reward signal at every point in time. We care about getting the maximum cumulative reward over time, the <strong>return</strong>. At any timestep <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-12" style="width: 0.478em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.368em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.615em, 1000.33em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-13"><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 0.866em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">t</script>, we can define the future return as:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/munderover&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-15" style="width: 28.997em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.389em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.181em, 1023.1em, 4.364em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-16"><span class="mtable" id="MathJax-Span-17" style="padding-right: 0.185em; padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 23.022em; height: 0px;"><span style="position: absolute; clip: rect(2.568em, 1002.75em, 5.867em, -999.998em); top: -4.067em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.008em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1002.75em, 4.254em, -999.998em); top: -4.69em; right: 0em;"><span class="mtd" id="MathJax-Span-18"><span class="mrow" id="MathJax-Span-19"><span class="msubsup" id="MathJax-Span-20"><span style="display: inline-block; position: relative; width: 1.102em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.77em, 4.144em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.847em; left: 0.772em;"><span class="texatom" id="MathJax-Span-22"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main; padding-left: 0.295em;">:<span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">=</span></span><span class="mtext" id="MathJax-Span-26" style="font-family: MathJax_Main; padding-left: 0.295em;">&nbsp;</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.521em, 1001.07em, 4.107em, -999.998em); top: -2.308em; right: 0em;"><span class="mtd" id="MathJax-Span-81"><span class="mrow" id="MathJax-Span-82"><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">=</span><span class="mtext" id="MathJax-Span-84" style="font-family: MathJax_Main; padding-left: 0.295em;">&nbsp;</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.071em;"></span></span><span style="position: absolute; clip: rect(2.788em, 1016.75em, 7.297em, -999.998em); top: -5.313em; left: 3.008em;"><span style="display: inline-block; position: relative; width: 16.754em; height: 0px;"><span style="position: absolute; clip: rect(2.165em, 1016.75em, 5.354em, -999.998em); top: -4.69em; left: 0em;"><span class="mtd" id="MathJax-Span-27"><span class="mrow" id="MathJax-Span-28"><span class="msubsup" id="MathJax-Span-29"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.44em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.847em; left: 0.442em;"><span class="mi" id="MathJax-Span-31" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-32" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span class="msubsup" id="MathJax-Span-34"><span style="display: inline-block; position: relative; width: 1.688em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.44em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.847em; left: 0.442em;"><span class="texatom" id="MathJax-Span-36"><span class="mrow" id="MathJax-Span-37"><span class="mi" id="MathJax-Span-38" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-39" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-40" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main; padding-left: 0.222em;">…</span><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-44" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.981em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.55em, 4.327em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.588em;"><span class="texatom" id="MathJax-Span-46"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span><span class="mo" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-51"><span style="display: inline-block; position: relative; width: 1.028em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.44em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.847em; left: 0.442em;"><span class="mi" id="MathJax-Span-53" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main; padding-left: 0.295em;">=</span><span class="munderover" id="MathJax-Span-55" style="padding-left: 0.295em;"><span style="display: inline-block; position: relative; width: 1.431em; height: 0px;"><span style="position: absolute; clip: rect(2.934em, 1001.39em, 4.547em, -999.998em); top: -3.994em; left: 0em;"><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.338em, 1001.25em, 4.217em, -999.998em); top: -2.857em; left: 0.112em;"><span class="texatom" id="MathJax-Span-57"><span class="mrow" id="MathJax-Span-58"><span class="msup" id="MathJax-Span-59"><span style="display: inline-block; position: relative; width: 0.442em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.22em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-60" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.258em;"><span class="mo" id="MathJax-Span-61" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-62" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.301em, 1000.51em, 4.107em, -999.998em); top: -5.13em; left: 0.478em;"><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-65" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 1.945em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.55em, 4.327em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.588em;"><span class="texatom" id="MathJax-Span-67"><span class="mrow" id="MathJax-Span-68"><span class="msup" id="MathJax-Span-69"><span style="display: inline-block; position: relative; width: 0.442em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.22em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-70" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.258em;"><span class="mo" id="MathJax-Span-71" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-74"><span style="display: inline-block; position: relative; width: 0.992em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.44em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.81em; left: 0.442em;"><span class="texatom" id="MathJax-Span-76"><span class="mrow" id="MathJax-Span-77"><span class="msup" id="MathJax-Span-78"><span style="display: inline-block; position: relative; width: 0.442em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.22em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-79" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.258em;"><span class="mo" id="MathJax-Span-80" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.191em, 1004.77em, 4.327em, -999.998em); top: -2.308em; left: 0em;"><span class="mtd" id="MathJax-Span-85"><span class="mrow" id="MathJax-Span-86"><span class="msubsup" id="MathJax-Span-87"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.44em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.847em; left: 0.442em;"><span class="mi" id="MathJax-Span-89" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span class="msubsup" id="MathJax-Span-92"><span style="display: inline-block; position: relative; width: 2.018em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.77em, 4.144em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.847em; left: 0.772em;"><span class="texatom" id="MathJax-Span-94"><span class="mrow" id="MathJax-Span-95"><span class="mi" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-97" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.317em;"></span></span><span style="position: absolute; clip: rect(4.804em, 1001.17em, 6.014em, -999.998em); top: -3.994em; left: 21.776em;"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1001.17em, 4.364em, -999.998em); top: -2.308em; right: 0em;"><span class="mtd" id="MathJax-Span-100"><span class="mrow" id="MathJax-Span-101"><span class="mi" id="MathJax-Span-102"></span><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-104" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.407em; border-left: 0px solid; width: 0px; height: 5.457em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>:=</mo><mtext>&nbsp;</mtext></mtd><mtd><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>γ</mi><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>…</mo><mo>+</mo><msup><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>T</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msup><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>−</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub></mtd></mtr><mtr><mtd><mo>=</mo><mtext>&nbsp;</mtext></mtd><mtd><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>γ</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo></mtd><mtd><mi></mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">% <![CDATA[
\begin{align*}
G_{t} :=\ &r_t + \gamma r_{t+1} + \ldots + \gamma^{T - t}r_T = \sum_{t'=t}^T \gamma^{t'-t}r_{t'}\\
       =\ &r_t + \gamma G_{t + 1}, & (1)
\end{align*} %]]></script>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-106" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.798em, 1000.77em, 2.604em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-107"><span class="msubsup" id="MathJax-Span-108"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.44em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.847em; left: 0.442em;"><span class="mi" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.225em; border-left: 0px solid; width: 0px; height: 0.82em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">r_t</script> is the reward at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-111" style="width: 0.478em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.368em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.615em, 1000.33em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-112"><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 0.866em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">t</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-114" style="width: 0.882em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.698em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.578em, 1000.7em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-115"><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.112em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 0.911em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">T</script> is the time-step where the <strong>episode</strong> terminates, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-117" style="width: 5.317em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.291em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.578em, 1004.22em, 2.678em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-118"><span class="mn" id="MathJax-Span-119" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main; padding-left: 0.295em;">≤</span><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.295em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main; padding-left: 0.295em;">≤</span><span class="mn" id="MathJax-Span-123" style="font-family: MathJax_Main; padding-left: 0.295em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.316em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>≤</mo><mi>γ</mi><mo>≤</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-8">0 \leq \gamma \leq 1</script> is the <strong>discount rate</strong>. The discount rate is used to control how much we care about future rewards. An episode can be seen as one instance of learning. In the Atari world, an episode is one round of playing before a game over. Equation 1 provides us with a very important identity for learning later on.</p>

<p>Since we don’t know what rewards we are going to get in the future, we have to work with the <strong>expected</strong> future (discounted) return. This leads us to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-124" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">Q</script>-values, defined as the expected future return, given that we take action <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-127" style="width: 0.662em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.798em, 1000.48em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-128"><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 0.639em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">a</script> in state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-130" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.478em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.798em, 1000.44em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-131"><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 0.639em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">s</script> and follow policy <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-133" style="width: 0.735em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.588em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.798em, 1000.59em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 0.639em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">\pi</script> afterwards:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-136" style="width: 19.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.324em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.505em, 1015.25em, 2.714em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-137"><span class="msubsup" id="MathJax-Span-138"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.74em, 4.291em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.808em;"><span class="mi" id="MathJax-Span-140" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-142" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">a</span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main; padding-left: 0.295em;">:<span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-147" style="padding-left: 0.295em;"><span style="display: inline-block; position: relative; width: 1.138em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.62em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="texatom" id="MathJax-Span-148"><span class="mrow" id="MathJax-Span-149"><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.847em; left: 0.662em;"><span class="mi" id="MathJax-Span-151" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-153"><span style="display: inline-block; position: relative; width: 1.102em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.77em, 4.144em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.847em; left: 0.772em;"><span class="mi" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main; padding-left: 0.295em;">∣</span><span class="msubsup" id="MathJax-Span-157" style="padding-left: 0.295em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.66em, 4.144em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.847em; left: 0.625em;"><span class="mi" id="MathJax-Span-159" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main; padding-left: 0.295em;">=</span><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.295em;">s</span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-163" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.74em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.847em; left: 0.735em;"><span class="mi" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main; padding-left: 0.295em;">=</span><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.295em;">a</span><span class="mo" id="MathJax-Span-168" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-169" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.361em; border-left: 0px solid; width: 0px; height: 1.32em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>Q</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>:=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mi>π</mi></msub><mo stretchy="false">[</mo><msub><mi>G</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo stretchy="false">]</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">Q^\pi(s, a) := \mathbb{E}_\pi[G_t \mid S_t = s, A_t = a].</script>

<p>The expectation is with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-170" style="width: 0.735em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.588em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.798em, 1000.59em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-171"><span class="mi" id="MathJax-Span-172" style="font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 0.639em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">\pi</script>, since it determines (along with the environment) which states are visited, and in turn which rewards are obtained.</p>

<h3 id="q-learning" class=""><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-173" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-174"><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">Q</script>-Learning</h3>

<p>If we can learn these <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-176" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-177"><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">Q</script>-values, we know which actions yield the best returns, allowing us to optimize our policy. One technique based on this principle is <strong><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-179" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-180"><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">Q</script>-Learning</strong>. In <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-182" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-183"><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">Q</script>-learning, we learn the optimal <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-185" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-186"><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">Q</script>-values directly from experienced environment transitions <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-188" style="width: 5.427em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.364em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.468em, 1004.25em, 2.714em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-189"><span class="mo" id="MathJax-Span-190" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">a</span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">r</span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-197" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.4em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-198" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.478em;"><span class="mo" id="MathJax-Span-199" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-200" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.361em; border-left: 0px solid; width: 0px; height: 1.366em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-20">(s, a, r, s')</script>, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-201" style="width: 0.918em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.468em, 1000.74em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-202"><span class="msup" id="MathJax-Span-203"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.4em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.478em;"><span class="mo" id="MathJax-Span-205" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 1.048em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>s</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-21">s'</script> is the state following <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-206" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.478em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.798em, 1000.44em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-207"><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 0.639em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">s</script>. The following update rule is used:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-209" style="width: 28.374em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.876em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.431em, 1022.8em, 3.264em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-210"><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-212" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-214" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">a</span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main; padding-left: 0.295em;">←</span><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.295em;">Q</span><span class="mo" id="MathJax-Span-219" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">a</span><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-224" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">α</span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span class="munderover" id="MathJax-Span-230" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 1.871em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1001.84em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mo" id="MathJax-Span-231" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.338em, 1000.55em, 4.217em, -999.998em); top: -3.297em; left: 0.662em;"><span class="texatom" id="MathJax-Span-232"><span class="mrow" id="MathJax-Span-233"><span class="msup" id="MathJax-Span-234"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px;"><span style="position: absolute; clip: rect(3.558em, 1000.37em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-235" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.368em;"><span class="mo" id="MathJax-Span-236" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">Q</span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-239"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.4em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.478em;"><span class="mo" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-243" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.51em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.515em;"><span class="mo" id="MathJax-Span-245" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">Q</span><span class="mo" id="MathJax-Span-249" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-251" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">a</span><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.043em; border-left: 0px solid; width: 0px; height: 2.093em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>α</mi><mo stretchy="false">(</mo><mi>r</mi><mo>+</mo><mi>γ</mi><munder><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>a</mi><mo>′</mo></msup></mrow></munder><mi>Q</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo>,</mo><msup><mi>a</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>−</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-23">Q(s, a) \leftarrow Q(s, a) + \alpha (r + \gamma \max_{a'} Q(s', a') - Q(s, a)),</script>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-256" style="width: 0.845em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.662em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.798em, 1000.62em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-257"><span class="mi" id="MathJax-Span-258" style="font-family: MathJax_Math; font-style: italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 0.639em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">\alpha</script> is a learning rate parameter controlling learning speed. The sample transitions can be generated using <em>any</em> policy, such as an <a href="https://link/" target="_blank">epsilon-greedy policy</a>, making <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-259" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-260"><span class="mi" id="MathJax-Span-261" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">Q</script>-learning an <strong>off-policy</strong> method.</p>

<p>However, this assumes we can store all the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-262" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-263"><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">Q</script>-values for each state-action pair in a table. In most realistic scenarios such as playing Atari games, this <strong>tabular</strong> approach is not possible. It is therefore usually necessary to <strong>approximate</strong> the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-265" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-266"><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">Q</script>-values.</p>

<p>In DQN, the update is a little bit different, since it uses function approximation with parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-268" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.478em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.48em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">\theta</script>, i.e. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-271" style="width: 10.376em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.36em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.505em, 1008.25em, 2.714em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-272"><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-274" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-275" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">a</span><span class="mo" id="MathJax-Span-278" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main; padding-left: 0.295em;">=</span><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.295em;">Q</span><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-283" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">a</span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">θ</span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.361em; border-left: 0px solid; width: 0px; height: 1.32em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-29">Q(s,a) = Q(s, a; \theta)</script>. It is equivalent (footnote here: not truly equivalent) to minimizing the mean squared error between <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-288" style="width: 10.779em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.69em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.468em, 1008.58em, 2.714em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-289"><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span class="munderover" id="MathJax-Span-293" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 2.495em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1001.84em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.81em; left: 1.871em;"><span class="texatom" id="MathJax-Span-295"><span class="mrow" id="MathJax-Span-296"><span class="msup" id="MathJax-Span-297"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px;"><span style="position: absolute; clip: rect(3.558em, 1000.37em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-298" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.368em;"><span class="mo" id="MathJax-Span-299" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-300" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">Q</span><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-302"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.4em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.478em;"><span class="mo" id="MathJax-Span-304" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-306" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.51em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.515em;"><span class="mo" id="MathJax-Span-308" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-309" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.361em; border-left: 0px solid; width: 0px; height: 1.366em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>+</mo><mi>γ</mi><munder><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>a</mi><mo>′</mo></msup></mrow></munder><mi>Q</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo>,</mo><msup><mi>a</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-30">r + \gamma \max_{a'} Q(s', a')</script> and the current <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-310" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-311"><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">Q</script>-value using stochastic gradient descent:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-313" style="width: 34.936em; display: inline-block;"><span style="display: inline-block; position: relative; width: 28.154em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.442em, 1027.86em, 3.741em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-314"><span class="mtable" id="MathJax-Span-315" style="padding-right: 0.185em; padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 27.788em; height: 0px;"><span style="position: absolute; clip: rect(2.091em, 1001.69em, 4.584em, -999.998em); top: -3.994em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.688em; height: 0px;"><span style="position: absolute; clip: rect(3.008em, 1001.69em, 4.107em, -999.998em); top: -4.874em; right: 0em;"><span class="mtd" id="MathJax-Span-316"><span class="mrow" id="MathJax-Span-317"><span class="msubsup" id="MathJax-Span-318"><span style="display: inline-block; position: relative; width: 1.688em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.48em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-319" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.478em;"><span class="texatom" id="MathJax-Span-320"><span class="mrow" id="MathJax-Span-321"><span class="mi" id="MathJax-Span-322" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-323" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-324" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.887em, 1000em, 4.107em, -999.998em); top: -3.517em; right: 0em;"><span class="mtd" id="MathJax-Span-333"><span class="mrow" id="MathJax-Span-334"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.165em, 1022.73em, 5.427em, -999.998em); top: -4.03em; left: 1.688em;"><span style="display: inline-block; position: relative; width: 22.802em; height: 0px;"><span style="position: absolute; clip: rect(3.044em, 1003.08em, 4.181em, -999.998em); top: -4.874em; left: 0em;"><span class="mtd" id="MathJax-Span-325"><span class="mrow" id="MathJax-Span-326"><span class="mi" id="MathJax-Span-327"></span><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main; padding-left: 0.295em;">←</span><span class="msubsup" id="MathJax-Span-329" style="padding-left: 0.295em;"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.48em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.478em;"><span class="mi" id="MathJax-Span-331" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-332" style="font-family: MathJax_Main;">−</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.044em, 1022.73em, 4.914em, -999.998em); top: -3.517em; left: 0em;"><span class="mtd" id="MathJax-Span-335"><span class="mrow" id="MathJax-Span-336"><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math; font-style: italic;">α</span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-339" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-341" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span class="munderover" id="MathJax-Span-343" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 1.871em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1001.84em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mo" id="MathJax-Span-344" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.338em, 1000.55em, 4.217em, -999.998em); top: -3.297em; left: 0.662em;"><span class="texatom" id="MathJax-Span-345"><span class="mrow" id="MathJax-Span-346"><span class="msup" id="MathJax-Span-347"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px;"><span style="position: absolute; clip: rect(3.558em, 1000.37em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-348" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.368em;"><span class="mo" id="MathJax-Span-349" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">Q</span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-352"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.4em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.478em;"><span class="mo" id="MathJax-Span-354" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-356" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.51em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.515em;"><span class="mo" id="MathJax-Span-358" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-359" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-360" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.48em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-361" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.478em;"><span class="mi" id="MathJax-Span-362" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-363" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-364" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">Q</span><span class="mo" id="MathJax-Span-366" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">a</span><span class="mo" id="MathJax-Span-370" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-371" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.48em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-372" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.478em;"><span class="mi" id="MathJax-Span-373" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-374" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-375" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-376"><span style="display: inline-block; position: relative; width: 1.468em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.77em, 4.144em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-377" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.737em; left: 0.845em;"><span class="texatom" id="MathJax-Span-378"><span class="mrow" id="MathJax-Span-379"><span class="msubsup" id="MathJax-Span-380"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.33em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-381" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.287em; left: 0.332em;"><span class="mi" id="MathJax-Span-382" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-383" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-384" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-386" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">a</span><span class="mo" id="MathJax-Span-388" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-389" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.48em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.478em;"><span class="mi" id="MathJax-Span-391" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-392" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-393" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-394" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.034em;"></span></span><span style="position: absolute; clip: rect(3.594em, 1001.17em, 4.804em, -999.998em); top: -3.994em; left: 26.505em;"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1001.17em, 4.364em, -999.998em); top: -3.517em; right: 0em;"><span class="mtd" id="MathJax-Span-395"><span class="mrow" id="MathJax-Span-396"><span class="mi" id="MathJax-Span-397"></span><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-399" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-400" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.634em; border-left: 0px solid; width: 0px; height: 3.866em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup></mtd><mtd><mi></mi><mo stretchy="false">←</mo><msup><mi>θ</mi><mi>t</mi></msup><mo>−</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi>α</mi><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>r</mi><mo>+</mo><mi>γ</mi><munder><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>a</mi><mo>′</mo></msup></mrow></munder><mi>Q</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo>,</mo><msup><mi>a</mi><mo>′</mo></msup><mo>;</mo><msup><mi>θ</mi><mi>t</mi></msup><mo stretchy="false">)</mo><mo>−</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><msup><mi>θ</mi><mi>t</mi></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>θ</mi><mi>t</mi></msup></mrow></msub><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><msup><mi>θ</mi><mi>t</mi></msup><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>,</mo></mtd><mtd><mi></mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-32">% <![CDATA[
\begin{align*}
\theta^{t+1} &\leftarrow \theta^t -
\\
&\alpha [(r + \gamma \max_{a'} Q(s', a'; \theta^t) - Q(s, a; \theta^t)) \nabla_{\theta^t} Q(s, a; \theta^t)], & (2)
\end{align*} %]]></script>

<!--- - q learning
    - definitions return, q-learning objective -->

<h3 id="function-approximation" class="">Function Approximation</h3>

<p>Imagine mapping an Atari game state to a <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-401" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-402"><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">Q</script>-value directly from image data. Assuming RGB pixel values and an 84x84 pixel screen, we would need to store <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;256&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;84&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mn&gt;84&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-404" style="width: 6.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.207em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.395em, 1005.21em, 2.714em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-405"><span class="mo" id="MathJax-Span-406" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-407" style="font-family: MathJax_Main;">256</span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mn" id="MathJax-Span-409" style="font-family: MathJax_Main; padding-left: 0.222em;">3</span><span class="msubsup" id="MathJax-Span-410"><span style="display: inline-block; position: relative; width: 2.091em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.29em, 4.364em, -999.998em); top: -3.994em; left: 0em;"><span class="mo" id="MathJax-Span-411" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.405em;"><span class="texatom" id="MathJax-Span-412"><span class="mrow" id="MathJax-Span-413"><span class="mn" id="MathJax-Span-414" style="font-size: 70.7%; font-family: MathJax_Main;">84</span><span class="mo" id="MathJax-Span-415" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mn" id="MathJax-Span-416" style="font-size: 70.7%; font-family: MathJax_Main;">84</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.361em; border-left: 0px solid; width: 0px; height: 1.457em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>256</mn><mo>⋅</mo><mn>3</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>84</mn><mo>⋅</mo><mn>84</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-34">(256 \cdot 3)^{84\cdot84}</script> values, one for each pixel configuration. Besides this impracticality, we would also not generalize well between different pixel states, as these do not capture latent structure efficiently.</p>

<p>Therefore, <strong>function approximation</strong> is used to predict <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-417" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-418"><span class="mi" id="MathJax-Span-419" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">Q</script>-values using some learned function, given a state or state-action pair. This allows <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-420" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-421"><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">Q</script>-values to be represented in a compressed form (the parameters) and generalization over similar states. For a long time, linear models were the go-to function approximator, since they are theoretically relatively straightforward to study. However, these models are in many cases too simple to accurately capture complex system dynamics. A next obvious option was using <strong>neural networks</strong>. However, while neural networks can learn very complex dynamics, they are also notoriously unstable.</p>

<p>This instability prevented neural networks from being used successfully in RL for quite some time. That is, until DQN proposed several techniques to combat this instability, including <strong>experience replay</strong> and <strong>target networks</strong>.</p>

<h3 id="experience-replay" class="">Experience Replay</h3>

<p>We’ve seen that DQN learns <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-423" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-424"><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">Q</script>-values using neural networks. This can be seen as supervised learning. In this paradigm, a key assumption is that data is independently and identically distributed (iid). In RL however, this does not hold. Subsequent states are highly correlated, and the data distribution changes as the agent learns. To deal with this, DQN saves the last <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-426" style="width: 1.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.882em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.88em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-427"><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 0.957em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">N</script> experienced transitions in memory with some finite capacity <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-429" style="width: 1.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.882em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.88em, 2.458em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-430"><span class="mi" id="MathJax-Span-431" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left: 0px solid; width: 0px; height: 0.957em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">N</script>. When performing a <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-432" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-433"><span class="mi" id="MathJax-Span-434" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">Q</script>-value update, it uses experiences randomly sampled from memory.</p>

<p>The idea of sampling randomly is to <strong>break the correlation</strong> between updated experiences, increasing sample efficiency and reducing variance. The authors also argue that the technique: helps by avoiding unwanted feedback loops; and averages the behavior distribution over many previous states, smoothing out learning and avoiding divergence.</p>

<h3 id="target-networks" class="">Target Networks</h3>

<p>In the parameter update given by Equation 2, the Q network predicts both the current state’s predicted <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-435" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-436"><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">Q</script>-value, as well as the <strong>target</strong>: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-438" style="width: 12.319em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.936em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.431em, 1009.83em, 2.714em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-439"><span class="mi" id="MathJax-Span-440" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-441" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-442" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span class="munderover" id="MathJax-Span-443" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 2.495em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1001.84em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mo" id="MathJax-Span-444" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.81em; left: 1.871em;"><span class="texatom" id="MathJax-Span-445"><span class="mrow" id="MathJax-Span-446"><span class="msup" id="MathJax-Span-447"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px;"><span style="position: absolute; clip: rect(3.558em, 1000.37em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-448" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.368em;"><span class="mo" id="MathJax-Span-449" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.185em;">Q</span><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-452"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.4em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-453" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.478em;"><span class="mo" id="MathJax-Span-454" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-456" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.51em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.515em;"><span class="mo" id="MathJax-Span-458" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-460" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.191em, 1000.48em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-461" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.478em;"><span class="mi" id="MathJax-Span-462" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-463" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.361em; border-left: 0px solid; width: 0px; height: 1.411em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>+</mo><mi>γ</mi><munder><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>a</mi><mo>′</mo></msup></mrow></munder><mi>Q</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo>,</mo><msup><mi>a</mi><mo>′</mo></msup><mo>;</mo><msup><mi>θ</mi><mi>t</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-42">r + \gamma \max_{a'} Q(s', a'; \theta^t)</script>. However, after the parameters of the network are updated, the target value changes as well. This is like asking the network to learn to throw a bull’s eye, but then moving the dart board somewhere else. This leads to instability.</p>

<p>To tackle this problem, DQN proposes using a <strong>target network</strong>. The idea is to compute the target using a (target) network that is not updated for some amount of time-steps. That way, the targets don’t “move” during training. Every <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-464" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.77em, 2.495em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-465"><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.089em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">C</script> time-steps, the target network is synchronized with the current <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-467" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-468"><span class="mi" id="MathJax-Span-469" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">Q</script> network.</p>

<!--- - function approximation
- neural networks
- dqn's
  - what is different about dqn's
    - way of modelling
        - stack last 4 frames
    - most importantly: 2 techniques
        - experience replay
          - store samples in memory and sample.
          - Why? Break correlations. ML methods require iid data.
        - target networks
            - one network stays fixed for some period of time, this is the target network
            - why? this stabilizes learning -->

<h2 id="divergence" class="">Divergence</h2>

<p>One of our goals was to find out to what extent the two techniques above help dealing with divergence in the learning process. When learning diverges, we are not able to learn properly. Every state-action value is assumed to exist and be finite. If the algorithm doesn’t converge, it means we are not in a local or global optimum.</p>

<p>For most environments, we don’t know the true Q-values. How do we know when divergence occurs then? <a href="http://arxiv.org/abs/1812.02648" target="_blank">Van Hasselt et al.</a> use a clever trick to define <strong>soft divergence</strong>. To avoid instability, DQN clips all rewards to the range <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-470" style="width: 3.484em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.788em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.505em, 1002.68em, 2.714em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-471"><span class="mo" id="MathJax-Span-472" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-474" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-475" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-476" style="font-family: MathJax_Main; padding-left: 0.185em;">1</span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.361em; border-left: 0px solid; width: 0px; height: 1.32em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-45">[-1, 1]</script>. Thus, the future return at some state is bounded by:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/munderover&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/munderover&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/munderover&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-478" style="width: 27.604em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.253em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.515em, 1022.14em, 3.704em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-479"><span class="munderover" id="MathJax-Span-480"><span style="display: inline-block; position: relative; width: 1.431em; height: 0px;"><span style="position: absolute; clip: rect(2.934em, 1001.39em, 4.547em, -999.998em); top: -3.994em; left: 0em;"><span class="mo" id="MathJax-Span-481" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.338em, 1001.25em, 4.217em, -999.998em); top: -2.857em; left: 0.112em;"><span class="texatom" id="MathJax-Span-482"><span class="mrow" id="MathJax-Span-483"><span class="msup" id="MathJax-Span-484"><span style="display: inline-block; position: relative; width: 0.442em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.22em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-485" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.258em;"><span class="mo" id="MathJax-Span-486" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-487" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-488" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.301em, 1000.51em, 4.107em, -999.998em); top: -5.13em; left: 0.478em;"><span class="mi" id="MathJax-Span-489" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-490" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 1.945em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.55em, 4.327em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-491" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.588em;"><span class="texatom" id="MathJax-Span-492"><span class="mrow" id="MathJax-Span-493"><span class="msup" id="MathJax-Span-494"><span style="display: inline-block; position: relative; width: 0.442em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.22em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-495" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.258em;"><span class="mo" id="MathJax-Span-496" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-497" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-498" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-499"><span class="mrow" id="MathJax-Span-500"><span class="mo" id="MathJax-Span-501" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-502"><span style="display: inline-block; position: relative; width: 0.992em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.44em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.81em; left: 0.442em;"><span class="texatom" id="MathJax-Span-504"><span class="mrow" id="MathJax-Span-505"><span class="msup" id="MathJax-Span-506"><span style="display: inline-block; position: relative; width: 0.442em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.22em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-507" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.258em;"><span class="mo" id="MathJax-Span-508" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-509"><span class="mrow" id="MathJax-Span-510"><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-512" style="font-family: MathJax_Main; padding-left: 0.295em;">≤</span><span class="munderover" id="MathJax-Span-513" style="padding-left: 0.295em;"><span style="display: inline-block; position: relative; width: 1.431em; height: 0px;"><span style="position: absolute; clip: rect(2.934em, 1001.39em, 4.547em, -999.998em); top: -3.994em; left: 0em;"><span class="mo" id="MathJax-Span-514" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.338em, 1001.25em, 4.217em, -999.998em); top: -2.857em; left: 0.112em;"><span class="texatom" id="MathJax-Span-515"><span class="mrow" id="MathJax-Span-516"><span class="msup" id="MathJax-Span-517"><span style="display: inline-block; position: relative; width: 0.442em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.22em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-518" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.258em;"><span class="mo" id="MathJax-Span-519" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-520" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-521" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.484em, 1000.66em, 4.107em, -999.998em); top: -5.13em; left: 0.368em;"><span class="mi" id="MathJax-Span-522" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-523" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 1.945em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.55em, 4.327em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-524" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.588em;"><span class="texatom" id="MathJax-Span-525"><span class="mrow" id="MathJax-Span-526"><span class="msup" id="MathJax-Span-527"><span style="display: inline-block; position: relative; width: 0.442em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.22em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-528" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.258em;"><span class="mo" id="MathJax-Span-529" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-530" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-531" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-532"><span class="mrow" id="MathJax-Span-533"><span class="mo" id="MathJax-Span-534" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-535"><span style="display: inline-block; position: relative; width: 0.992em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.44em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-536" style="font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.81em; left: 0.442em;"><span class="texatom" id="MathJax-Span-537"><span class="mrow" id="MathJax-Span-538"><span class="msup" id="MathJax-Span-539"><span style="display: inline-block; position: relative; width: 0.442em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.22em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-540" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.258em;"><span class="mo" id="MathJax-Span-541" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-542"><span class="mrow" id="MathJax-Span-543"><span class="mo" id="MathJax-Span-544" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-545" style="font-family: MathJax_Main; padding-left: 0.295em;">≤</span><span class="munderover" id="MathJax-Span-546" style="padding-left: 0.295em;"><span style="display: inline-block; position: relative; width: 1.431em; height: 0px;"><span style="position: absolute; clip: rect(2.934em, 1001.39em, 4.547em, -999.998em); top: -3.994em; left: 0em;"><span class="mo" id="MathJax-Span-547" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.338em, 1001.25em, 4.217em, -999.998em); top: -2.857em; left: 0.112em;"><span class="texatom" id="MathJax-Span-548"><span class="mrow" id="MathJax-Span-549"><span class="msup" id="MathJax-Span-550"><span style="display: inline-block; position: relative; width: 0.442em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.22em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-551" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.258em;"><span class="mo" id="MathJax-Span-552" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-553" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-554" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.484em, 1000.66em, 4.107em, -999.998em); top: -5.13em; left: 0.368em;"><span class="mi" id="MathJax-Span-555" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-556" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 1.945em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.55em, 4.327em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-557" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.588em;"><span class="texatom" id="MathJax-Span-558"><span class="mrow" id="MathJax-Span-559"><span class="msup" id="MathJax-Span-560"><span style="display: inline-block; position: relative; width: 0.442em; height: 0px;"><span style="position: absolute; clip: rect(3.448em, 1000.22em, 4.107em, -999.998em); top: -3.994em; left: 0em;"><span class="mi" id="MathJax-Span-561" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.25em; left: 0.258em;"><span class="mo" id="MathJax-Span-562" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-563" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-564" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-565" style="font-family: MathJax_Main; padding-left: 0.295em;">=</span><span class="mfrac" id="MathJax-Span-566" style="padding-left: 0.295em;"><span style="display: inline-block; position: relative; width: 2.385em; height: 0px; margin-right: 0.112em; margin-left: 0.112em;"><span style="position: absolute; clip: rect(3.228em, 1000.44em, 4.107em, -999.998em); top: -4.654em; left: 50%; margin-left: -0.255em;"><span class="mn" id="MathJax-Span-567" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1002.27em, 4.327em, -999.998em); top: -3.297em; left: 50%; margin-left: -1.135em;"><span class="mrow" id="MathJax-Span-568"><span class="mn" id="MathJax-Span-569" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-570" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-571" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.882em, 1002.38em, 1.175em, -999.998em); top: -1.281em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.6px solid; width: 2.385em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.065em;"></span></span></span></span><span class="mo" id="MathJax-Span-572" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-573" style="font-family: MathJax_Main; padding-left: 0.185em;">(</span><span class="mn" id="MathJax-Span-574" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-575" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.589em; border-left: 0px solid; width: 0px; height: 3.82em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msup><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>−</mo><mi>t</mi></mrow></msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>≤</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi mathvariant="normal">∞</mi></munderover><msup><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>−</mo><mi>t</mi></mrow></msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>≤</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi mathvariant="normal">∞</mi></munderover><msup><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>−</mo><mi>t</mi></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>γ</mi></mrow></mfrac><mo>,</mo><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-46">\sum_{t'=t}^T \gamma^{t'-t}|r_{t'}| \leq \sum_{t'=t}^\infty \gamma^{t'-t}|r_{t'}| \leq \sum_{t'=t}^\infty \gamma^{t'-t} = \frac{1}{1-\gamma}, (3)</script>

<p>where the last equality is a general result for geometric series. This means that any <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-576" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-577"><span class="mi" id="MathJax-Span-578" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">Q</script>-value is theoretically bounded by (3). Thus, if the maximum absolute <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-579" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.541em, 1000.74em, 2.641em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-580"><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">Q</script>-value exceeds this bound, we say that soft divergence occurs.</p>

<!--- - goal of this blog post is to find out to what extent each of these techniques help to deal with divergence
- if the networks diverge, we are most likely not learning anything meaningful.
- Every state-action value is assumed to exist and be finite. If the algo doesn't converge, it means we are not in
  a local or global optimum.
- Defining divergence
    - For most environments, we don't know the true Q-values. How do we know when divergence occurs then?
    - intuition: if some state-action pairs get assigned unrealistically high values, we say there is **soft divergence**.
    - when are values too high? Show discount_factor / max q value calculation.
    - reward clipping -->

<h2 id="experimental-setup" class="active">Experimental setup</h2>
<p>We try to follow the experimental setup from the <a href="https://www.cs.toronto.edu/~vmnih/docs/dqn.pdf" target="_blank">DQN paper</a> closely. The loss term we use is the mean-squared error which is clipped in the range [-1; 1], as it was reported to improve the stability of the algorithm. The error is optimized by <a href="https://arxiv.org/pdf/1412.6980.pdf" target="_blank">Adam</a> with a learning rate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.001&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-582" style="width: 5.317em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.291em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.578em, 1004.22em, 2.495em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-583"><span class="mi" id="MathJax-Span-584" style="font-family: MathJax_Math; font-style: italic;">α</span><span class="mo" id="MathJax-Span-585" style="font-family: MathJax_Main; padding-left: 0.295em;">=</span><span class="mn" id="MathJax-Span-586" style="font-family: MathJax_Main; padding-left: 0.295em;">0.001</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.089em; border-left: 0px solid; width: 0px; height: 0.957em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi><mo>=</mo><mn>0.001</mn></math></span></span><script type="math/tex" id="MathJax-Element-49">\alpha = 0.001</script>. The choice of optimizer deviates from the original paper but has shown great success in deep learning recently. Additional experiments with different values of the learning rate and the contribution of error clipping are left for future work.</p>

<p>Since divergence can now be quantified, we use it as a metric to compare the improvement that each of the tricks brings to DQN. We run each experiment 25 times with 25 different random seeds to achieve statistically significant results. We chose this number to be as high as possible taking into account our computational budget as well. We judge whether the model has diverged by looking at the maximal Q-value predicted in the last step of the last episode - if it is above the threshold <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-587" style="width: 2.018em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.615em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.358em, 1001.62em, 2.971em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-588"><span class="mfrac" id="MathJax-Span-589"><span style="display: inline-block; position: relative; width: 1.395em; height: 0px; margin-right: 0.112em; margin-left: 0.112em;"><span style="position: absolute; clip: rect(3.411em, 1000.29em, 4.107em, -999.998em); top: -4.397em; left: 50%; margin-left: -0.181em;"><span class="mn" id="MathJax-Span-590" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.411em, 1001.28em, 4.254em, -999.998em); top: -3.627em; left: 50%; margin-left: -0.658em;"><span class="mrow" id="MathJax-Span-591"><span class="mn" id="MathJax-Span-592" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-593" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-594" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.882em, 1001.39em, 1.175em, -999.998em); top: -1.281em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.6px solid; width: 1.395em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.065em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.68em; border-left: 0px solid; width: 0px; height: 1.775em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>γ</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-50">\frac{1}{1-\gamma}</script>, we say it has diverged. At the end, we compare the configurations by counting how many times each of them has diverged.</p>

<p>Even though the original paper uses a convolutional neural network to play Atari games, we focus on the simpler and less computationally expensive Cart Pole, Mountain Car and Acrobot. Our model is a single-layer fully-connected network with a hidden layer of size 128. We end up comparing 4 different setups for each environment - with both tricks, with each trick separately and without tricks at all.</p>

<p>All the experiments are run for 700 episodes which has been found to be enough for the agents to learn to win the games. For better exploration, we use an $\epsilon$$-greedy strategy, which we linearly anneal from 1 to a minimum of 0.1 during the first 400 episodes, and keep it fixed after. The discount factor is fixed to 0.99 for all the environments. Another hyperparameter is the frequency of updates for the target network (whenever the technique is used) and we empirically find 400, 2000, 2000 to work well for Mountain Car, Cart Pole and Acrobot respectively. No extensive hyperparameter search has been executed since the focus of our work is not SOTA performance but to compare the importance of the methods instead. The values of the parameters are selected manually for the configuration with no tricks and kept fixed for all other configurations of the respective environment.</p>

<!--- - Evaluating the different techniques
    - how we evaluate the techniques
      - run each setup for X runs
      - measure the fraction of times that soft divergence occurs
      - we do this by tracking the max absolute q value. If this is larger than X, we say divergence occurs
      - we do this for ? runs, because ??
      - the less divergence occurs, the more we say a technique helps avoiding divergence
    - explanation on environments
        - we need to do many runs to get some statistically significant results
        - we don't have the time and resources to investigate computationally expensive atari games
        - therefore, we investigate environments that are relatively simple and computationally inexpensive
        - we want enough environments such that we have divergence and convergence on each setup
    - the following hyperparameters are important
      - optimizer type
      - learning rate
      - discount factor
      - reward clipping
      - gradient clipping
      - …
We run each setup X times, and report the fraction of runs at which soft divergence occurs. We set the amount of runs to ?? to ensure statistically significant results, while taking our computational budget into account.

We try to make sure our experimental setup coincides with the DQN implementation as much as possible. Due to computational constraints, we unfortunately can't run any experiments on Atari games. Instead, we investigate the following simpler environments: Cart-Pole, Mountain Car, Inverse Pendulum, ... . We want enough environments such that we have divergence and convergence on each setup. 

We use the following hyperparameter settings in all our experiments:
- We use an epsilon-greedy exploration strategy, where epsilon is linearly annealed over ?? steps to 0.05, after which it stays at that level.
- Learning rate $$\alpha = x$$
- Adam optimizer
- reward clipping to range [-1, 1]
- gradient clipping to x
- discount factor x
      - we try to stick to the original paper as much as possible -->

<h2 id="results-and-discussion" class="">Results and Discussion</h2>

<p>After identifying the best hyper-parameters for each of our environments, we
looked at their divergence in four setups: with all tricks disabled, with
memory sampling, having a target network, and by having both tricks enabled.
Our results for MountainCar and Acrobot are shown below</p>

<p><img src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/violinplot_q_divergence_MountainCar-v0_0.99.png" alt="MountainCar divergence">
<img src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/violinplot_q_divergence_Acrobot-v0_0.99.png" alt="Acrobot divergence"></p>

<p>On the y-axis we see the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-595" style="width: 4.181em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.374em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.505em, 1003.26em, 2.714em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-596"><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main;">max</span><span class="texatom" id="MathJax-Span-598" style="padding-left: 0.185em;"><span class="mrow" id="MathJax-Span-599"><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="texatom" id="MathJax-Span-602"><span class="mrow" id="MathJax-Span-603"><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.361em; border-left: 0px solid; width: 0px; height: 1.32em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-51">\max |Q|</script> on a logarithmic scale.
The dashed line represents our theoretical maximal <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-605" style="width: 1.688em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.358em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.505em, 1001.25em, 2.714em, -999.998em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-606"><span class="texatom" id="MathJax-Span-607"><span class="mrow" id="MathJax-Span-608"><span class="mo" id="MathJax-Span-609" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="texatom" id="MathJax-Span-611"><span class="mrow" id="MathJax-Span-612"><span class="mo" id="MathJax-Span-613" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.361em; border-left: 0px solid; width: 0px; height: 1.32em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-52">|Q|</script>, above which we deem
the network to have diverged.
We see that with these environments, memory sampling has a limited effect on
slowing down divergence, whereas employing a separate target network is more
effective.
We also observe that when having both tricks,the network’s divergence is slowed
down even more.</p>

<p>Based on all our experiments we can say that divergence with DQN is
unavoidable, however it can be slowed down, allowing the network to learn more,
and achieve a higher score.
We can see this in the following plots, which show us the distribution of
obtained rewards.</p>

<p><img src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/violinplot_reward_MountainCar-v0_0.99.png" alt="MountainCar reward">
<img src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/violinplot_reward_Acrobot-v0_0.99.png" alt="Acrobot reward"></p>

<p>In the case of having both memory sampling and a target network enabled, we
achieved the highest reward.
However, the graphs also tell us that although the target network is more
effective at slowing down divergence, it also negatively influences DQN’s
learning capabilities.</p>

<!--- // TOOD: maybe think of a theoretical explanation of this? -->

<p>Lastly, we look at our results on the CartPole environment, for which we
explicitly disabled the error clipping.
Mnih et. al. argued that this improved the stability of the neural network,
however based on our findings, we can say that it also significantly reduced
the network’s learning capacity (and the reward obtained).</p>

<p><img src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/violinplot_q_divergence_CartPole-v0_0.99.jpeg" alt="CartPole divergence">
<!--- <> TODO: add reward image of CartPole. --></p>

<p>We see that error clipping is instrumental to making the tricks work.
Without error clipping, the tricks actually hasten the divergence, rather than
slow it down in our experiments.</p>

<h2 id="conclusions" class="">Conclusions</h2>

<p>With this article we looked at DQN’s stability and how memory sampling and a
separate target network help prevent divergence.
We came to the conclusion that both tricks are in fact necessary and that
without them the network is likely to spiral out of control within a
(relatively) short amount of episodes.
The target network trick proved to be more effective in slowing divergence, but
it caused less optimal parameters to be learned.
Combining the two tricks gave us the best results.</p>

<p>We also looked at the effects of clipping the error term during training, and
understood that netither of tricks is useful without the clipping in the simple environments we tested.</p>

<p><strong>Footnotes</strong></p>

        
          <form class="form" action="https://docs.google.com/forms/d/e/1FAIpQLSfQFkIS-WEOVXvkrFOAOqsFsUIWOxVN4XfugUVQjI93n6CVqg/formResponse" style="margin-top: 50px; border-radius:20px">
    If you like this post and would like to get updates on future blog posts, you can fill out your email here:
    <p></p>

    <label>Name</label>
    <input name="entry.660905987" type="text" required="">

    <label>Email</label>
    <input name="emailAddress" type="email" required="">

    <input type="submit" value="Send">
</form>
        
        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><svg class="svg-inline--fa fa-calendar-alt fa-w-14 fa-fw" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="calendar-alt" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"></path></svg><!-- <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Font Awesome fontawesome.com --> Updated:</strong> <time datetime="2020-10-11T22:38:20+02:00">October 11, 2020</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Investigating+the+effect+of+DQN+tricks+on+RL+divergence%20http%3A%2F%2Flocalhost%3A4000%2Fdqn-investigation%2F" class="btn btn--twitter" onclick="window.open(this.href, &#39;window&#39;, &#39;left=20,top=20,width=500,height=500,toolbar=1,resizable=0&#39;); return false;" title="Share on Twitter" target="_blank"><svg class="svg-inline--fa fa-twitter fa-w-16 fa-fw" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg><!-- <i class="fab fa-fw fa-twitter" aria-hidden="true"></i> Font Awesome fontawesome.com --><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fdqn-investigation%2F" class="btn btn--facebook" onclick="window.open(this.href, &#39;window&#39;, &#39;left=20,top=20,width=500,height=500,toolbar=1,resizable=0&#39;); return false;" title="Share on Facebook" target="_blank"><svg class="svg-inline--fa fa-facebook fa-w-16 fa-fw" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"></path></svg><!-- <i class="fab fa-fw fa-facebook" aria-hidden="true"></i> Font Awesome fontawesome.com --><span> Facebook</span></a>


<a href="https://www.reddit.com/submit?url=http%3A%2F%2Flocalhost%3A4000%2Fdqn-investigation%2F&amp;title=Investigating%20the%20effect%20of%20DQN%20tricks%20on%20RL%20divergence" class="btn btn--reddit" title="Share on Reddit" target="_blank"><svg class="svg-inline--fa fa-reddit fa-w-16 fa-fw" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="reddit" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"></path></svg><!-- <i class="fab fa-fw fa-reddit" aria-hidden="true"></i> Font Awesome fontawesome.com --><span> Reddit</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Flocalhost%3A4000%2Fdqn-investigation%2F" class="btn btn--linkedin" onclick="window.open(this.href, &#39;window&#39;, &#39;left=20,top=20,width=500,height=500,toolbar=1,resizable=0&#39;); return false;" title="Share on LinkedIn" target="_blank"><svg class="svg-inline--fa fa-linkedin fa-w-14 fa-fw" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg><!-- <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> Font Awesome fontawesome.com --><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="http://localhost:4000/self-explaining-neural-networks/" class="pagination--pager" title="Self-Explaining Neural Networks: A Review
">Previous</a>
    
    
      <a href="http://localhost:4000/dqn-investigation/#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope="" itemtype="https://schema.org/CreativeWork">
    
      
      <div class="archive__item-teaser">
        <img src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/teaser.png" alt="">
      </div>
    
    <div id="list__item-wrapper">
      
      
      <h2 class="archive__item-title" itemprop="headline">
        
          <a href="http://localhost:4000/self-explaining-neural-networks/" rel="permalink">Self-Explaining Neural Networks: A Review
</a>
        
      
      <!-- <h3 class="page__date"></h3> -->
      <p class="page__date">On <time datetime="2020-03-25T00:00:00+01:00">March 25, 2020</time></p>
      
      </h2>
      <!--  -->
      <p class="archive__item-excerpt" itemprop="description">For many applications, understanding why a predictive model makes a certain prediction can be of crucial importance. In the paper “Towards Robust Interpretability with Self-Explaining...</p>
      
    </div>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope="" itemtype="https://schema.org/CreativeWork">
    
      
      <div class="archive__item-teaser">
        <img src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/teaser(1).png" alt="">
      </div>
    
    <div id="list__item-wrapper">
      
      
      <h2 class="archive__item-title" itemprop="headline">
        
          <a href="http://localhost:4000/variational-bayes/" rel="permalink">Variational Bayesian Inference: A Fast Bayesian Take on Big Data.
</a>
        
      
      <!-- <h3 class="page__date"></h3> -->
      <p class="page__date">On <time datetime="2019-08-22T00:00:00+02:00">August 22, 2019</time></p>
      
      </h2>
      <!-- 
        <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  18 minute read
</p> -->
      <!--  -->
      <p class="archive__item-excerpt" itemprop="description">Compared to the frequentist paradigm, Bayesian inference allows more readily for dealing with and interpreting uncertainty, and for easier incorporation of prior beliefs. A big...</p>
      
    </div>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope="" itemtype="https://schema.org/CreativeWork">
    
      
      <div class="archive__item-teaser">
        <img src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/brain-scans-combined_invert.jpg" alt="">
      </div>
    
    <div id="list__item-wrapper">
      
      
      <h2 class="archive__item-title" itemprop="headline">
        
          <a href="http://localhost:4000/hello-world/" rel="permalink">Hello World!
</a>
        
      
      <!-- <h3 class="page__date"></h3> -->
      <p class="page__date">On <time datetime="2018-10-28T00:00:00+02:00">October 28, 2018</time></p>
      
      </h2>
      <!-- 
        <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read
</p> -->
      <!--  -->
      <p class="archive__item-excerpt" itemprop="description">Hi there! This is my first blog post ever!
</p>
      
    </div>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="http://localhost:4000/feed.xml"><svg class="svg-inline--fa fa-rss-square fa-w-14 fa-fw" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss-square" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM112 416c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm157.533 0h-34.335c-6.011 0-11.051-4.636-11.442-10.634-5.214-80.05-69.243-143.92-149.123-149.123-5.997-.39-10.633-5.431-10.633-11.441v-34.335c0-6.535 5.468-11.777 11.994-11.425 110.546 5.974 198.997 94.536 204.964 204.964.352 6.526-4.89 11.994-11.425 11.994zm103.027 0h-34.334c-6.161 0-11.175-4.882-11.427-11.038-5.598-136.535-115.204-246.161-251.76-251.76C68.882 152.949 64 147.935 64 141.774V107.44c0-6.454 5.338-11.664 11.787-11.432 167.83 6.025 302.21 141.191 308.205 308.205.232 6.449-4.978 11.787-11.432 11.787z"></path></svg><!-- <i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Font Awesome fontawesome.com --> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2020 Omar Elbaghdadi. Powered by <a href="https://jekyllrb.com/" rel="nofollow" target="_blank">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow" target="_blank">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/main.min.js"></script>
  <script src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/4eee35f757.js"></script>







    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/dqn-investigation/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/dqn-investigation"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://omarelb.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  

<script src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/MathJax.js" id=""></script> <!-- Add MathJax to page -->
<script>
  $(document.links).filter(function() {
    return this.hostname != window.location.hostname;
  }).attr('target', '_blank');
</script>




  

<iframe style="display: none;" src="./Investigating the effect of DQN tricks on RL divergence - Omar’s Blog_files/saved_resource.html"></iframe><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_AMS, sans-serif;"></div></div></body></html>